<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FARM-VSS</title>

  <!-- Main Stylesheet -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">


  <!-- Inline Styles for Overlays and Spinners -->

</head>

<body>
    <div id="summaryOverlay" class="overlay">
    <div class="overlay-content">
      <span class="close-btn" id="closeSummaryBtn">&times;</span>
      <h4>FARM Rules Summary (Troubleshoot by choosing different AI models and modifying prompt for more personalized results)</h4>
      <div id="summaryContent">
        <p>Loading summary...</p>
      </div>
    </div>
  </div>
  <!-- ======================= -->
  <!-- FIXED HEADER            -->
  <!-- ======================= -->
  <header class="site-header">
    <div class="header-left">
      <!-- Primary Logo -->
      <img src="{{ url_for('static', filename='logo.svg') }}" alt="FARM-VSS Logo" class="site-logo" />
    </div>

    <div class="header-center">
      <!-- Upload Form -->
      <form id="uploadForm" enctype="multipart/form-data" class="header-upload-form">
        <div class="custom-file">
          <input type="file" id="fileInput" name="file" accept=".csv, .xls, .xlsx" required />
          <label for="fileInput" class="custom-file-label">Please select .csv, .xlsx, or .xls file</label>
        </div>
        <button type="submit" class="btn">Upload</button>
      </form>
    </div>

    <div class="header-right">
      <!-- AI Model Selection -->
      <div class="model-selection">
        <img src="{{ url_for('static', filename='ollama_logo.svg') }}" alt="Ollama Logo" class="ollama-logo" />
        <h5 class="model-selection-title">Local AI Models (Ollama)</h5>

        <select id="modelSelect">
          <option value="" disabled selected>Loading models...</option>
        </select>
        <button id="setModelBtn" class="btn">Set Model</button>
        
        <!-- Additional Action Buttons -->
        <button id="genSummaryBtn" class="btn">Generate Summary</button>
        <button id="modifyPromptBtn" class="btn">Modify Prompt</button>
      </div>
    </div>
  </header>

  <!-- ======================= -->
  <!-- FIXED LEFT MENU         -->
  <!-- ======================= -->
  <div class="left-menu">
    <h3>FARM Thresholds</h3>
    <form id="thresholdForm">
      <label for="min_support">Minimum Significance/Support:</label>
      <input
        type="number"
        step="0.01"
        min="0"
        max="1"
        id="min_support"
        name="min_support"
        placeholder="by default: 0.15"
        required
      />

      <label for="min_certainty">Minimum Certainty/Confidence:</label>
      <input
        type="number"
        step="0.01"
        min="0"
        max="1"
        id="min_certainty"
        name="min_certainty"
        placeholder="by default: 0.60"
        required
      />

      <button class="btn" style="margin-top: 10px;" type="submit">Set Thresholds</button>
    </form>

    <h3 style="margin-top: 50px;">FARM Rule Exploration</h3>
    <form id="farmExplorationForm">
      <label for="step_support">Signif/Supp Step:</label>
      <input
        type="number"
        id="step_support"
        name="step_support"
        min="0.01"
        max="1"
        step="0.01"
        value="0.1"
        required
      />

      <label for="step_certainty">Cert/Conf Step:</label>
      <input
        type="number"
        id="step_certainty"
        name="step_certainty"
        min="0.01"
        max="1"
        step="0.01"
        value="0.1"
        required
      />

      <button type="submit" class="btn">Explore FARM Rules</button>
    </form>
  </div>

  <!-- ======================= -->
  <!-- SUMMARY OVERLAY         -->
  <!-- ======================= -->


  <!-- ======================= -->
  <!-- FIXED FOOTER            -->
  <!-- ======================= -->
  <footer class="site-footer">
    <p>
      FARM-VSS is a MIT licensed software, and is a part of VSSToolkits. 
      Developed by Vartul Shrivastava and Prof. Shekhar Shukla for research purposes with ❤️.
    </p>
  </footer>

  <!-- ======================= -->
  <!-- LOADING OVERLAY         -->
  <!-- ======================= -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="spinner"></div>
  </div>

  <!-- ======================= -->
  <!-- MAIN CONTENT            -->
  <!-- ======================= -->
  <main class="main-content">
    {% block content %}
    
    <!-- ========== PARTITION FORM SECTION ========== -->
    <section class="container partition-section" style="margin-top: 40px;">
      <h2>Select Columns, Configure Ranges, and Assign Weights</h2>
      <form id="partitionForm" style="display: none;">
        <input type="hidden" name="filepath" id="hiddenFilepath" />
        <div id="partitionUI">
          <p>No file uploaded yet.</p>
        </div>
        <div class="submit-container">
          <button type="submit" class="submit-button">Generate Rules</button>
        </div>
      </form>
    </section>

    <!-- ========== RESULTS SECTION ========== -->
    <section class="container results-section" style="margin-top: 20px;">
      <h2>Calculated FARM Rules and Analytics </h2>

      <!-- Collapsible #1: Processed Dataset -->
      <div class="collapsible-section no-content" id="processed-dataset-wrapper">
        <div class="collapsible-header" onclick="toggleSection('processed-dataset')">
          <h3>Processed Dataset</h3>
          <span class="toggle-icon" id="toggle-icon-processed-dataset">&#9660;</span>
        </div>
        <div class="collapsible-content" id="section-processed-dataset">
          <div class="table-container" id="ajaxResultsContainer">
            <p>No processed dataset yet.</p>
          </div>
        </div>
      </div>

      <!-- Collapsible #2: Fuzzy Membership Function Plots -->
      <div class="collapsible-section no-content" id="membership-plots-wrapper">
        <div class="collapsible-header" onclick="toggleSection('membership-plots')">
          <h3>Fuzzy Membership Function Plots</h3>
          <span class="toggle-icon" id="toggle-icon-membership-plots">&#9660;</span>
        </div>
        <div class="collapsible-content" id="section-membership-plots">
          <div class="plots-container" id="ajaxPlotsContainer">
            <p>No membership function plots yet.</p>
          </div>
        </div>
      </div>
      
  </div>
  
      <!-- Collapsible #3: Step-by-Step FARM -->
      <div class="collapsible-section no-content" id="farm-calculations-wrapper">
        <div class="collapsible-header" onclick="toggleSection('farm-calculations')">
          <h3>Step-by-Step FARM Calculations</h3>
          <span class="toggle-icon" id="toggle-icon-farm-calculations">&#9660;</span>
        </div>
        <div class="collapsible-content" id="section-farm-calculations">
          <div class="phase-combinations" id="ajaxStepsContainer">
            <p>No step-by-step details yet.</p>
          </div>
        </div>
      </div>

      <!-- Collapsible #4: FARM Rules -->
      <div class="collapsible-section no-content" id="farm-rules-wrapper">
        <div class="collapsible-header" onclick="toggleSection('farm-rules')">
          <h3>FARM Rules</h3>
          <span class="toggle-icon" id="toggle-icon-farm-rules">&#9660;</span>
        </div>
        <div class="collapsible-content" id="section-farm-rules">
          <div class="rules-container" id="ajaxRulesContainer">
            <p>No FARM rules generated yet.</p>
          </div>
        </div>
      </div>

      <div class="collapsible-section no-content" id="explored-farm-rules-wrapper">
        <div class="collapsible-header" onclick="toggleSection('explored-farm-rules')">
            <h3>Explored FARM Rules</h3>
            <span class="toggle-icon" id="toggle-icon-explored-farm-rules">&#9660;</span>
        </div>
        <div class="collapsible-content" id="section-explored-farm-rules">
            <div class="explored-summary" id="farmSummary">
                <p>No explored summary available yet.</p>
            </div>
            <div class="explored-details" id="farmDetails">
                <p>No detailed rules yet.</p>
            </div>
            <div class="explored-heatmap">
                <img id="farmPlotImage" alt="FARM Rules Heatmap" style="display: none;" />
            </div>
        </div>
    </div>  <div id="modifyPromptModal" class="overlay">
      <div class="overlay-content">
        <span class="close-btn" id="closeModifyPromptBtn">&times;</span>
        <h2>Modify Summary Prompt</h2>
        <textarea id="promptTextarea" rows="10" style="width: 100%; padding: 10px; font-size: 16px;"></textarea>
        <div style="margin-top: 20px; text-align: right;">
          <button id="savePromptBtn" class="p-btn" style="margin-right: 10px;">Save</button>
          <button id="resetPromptBtn" class="p-btn" style="margin-right: 10px;">Reset to Default</button>
          <button id="cancelPromptBtn" class="p-btn">Cancel</button>
        </div>
      </div>
    </div>
    
    </section>

</section>

    {% endblock %}
  </main>

  <!-- ======================= -->
  <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
</body>
</html>
